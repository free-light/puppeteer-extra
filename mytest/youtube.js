// puppeteer-extra is a drop-in replacement for puppeteer,
// it augments the installed puppeteer with plugin functionality.
// Any number of plugins can be added through `puppeteer.use()`
const puppeteer = require('puppeteer-extra')

// Add stealth plugin and use defaults (all tricks to hide puppeteer usage)
const StealthPlugin = require('puppeteer-extra-plugin-stealth')
puppeteer.use(StealthPlugin())

// Add adblocker plugin to block all ads and trackers (saves bandwidth)
const AdblockerPlugin = require('puppeteer-extra-plugin-adblocker')
puppeteer.use(AdblockerPlugin({ blockTrackers: false }))

const fs = require('fs').promises;

var Datastore = require('nedb')
  , db = new Datastore({ filename: './datafile', autoload: true });


const   keywords = ['å…è´¹æœºåœºv2ray', 'è€å¸æœºä¿®è½¦', 'ç½‘ç»œèµšé’±', 'ç¾å®¹å¥èº«', 'ç†è´¢è´¢ç»'];
//const keywords = ['ç½‘ç»œèµšé’±'];

const useLanch = true
const isScrollToBottom = false


async function scrollToBottom(page) {
  if (isScrollToBottom) {
    const distance = 200; // should be less than or equal to window.innerHeight
    const delay = 100;
    let count = 0;
    while (count < 50 && await page.evaluate(() => document.scrollingElement.scrollTop + window.innerHeight < document.scrollingElement.scrollHeight)) {
      await page.evaluate((y) => { document.scrollingElement.scrollBy(0, y); }, distance);
      await page.waitForTimeout(delay);
      count++
    }
  }
}

async function existsVid(vid) {

  var count = await new Promise((resolve, reject) => {
    db.count({vid: vid}, (err, count) => {
        if (err) reject(err);
        resolve(count);
    });
  });
  return count > 0;
}

function saveVid(vid) {
  db.insert({
    vid: vid
  }, (err, ret) => {
    let log = vid + ' has been handled succeed!'
    console.log(log)
  });
}

function getRandomInt(min, max) {
  min = Math.ceil(min);
  max = Math.floor(max);
  return Math.floor(Math.random() * (max - min) + min); //The maximum is exclusive and the minimum is inclusive
}
async function autoComment(page, video) {
  //thumbnail = await video.$('#thumbnail')
  const yourHref = await video.$eval('#thumbnail', anchor => anchor.getAttribute('href'));
  const hrefAry = yourHref.split(new RegExp('[=&]'));
  let vid = '';
  if (hrefAry.length >= 2) {
      vid = hrefAry[1]
  } 
  //const yourHref = await page.evaluate(anchor => anchor.getAttribute('href'), thumbnail);

  if (hrefAry.length >= 3 || hrefAry.length <= 1 || await existsVid(vid)) {
    let log = vid + ' has been handled already...'
    console.log(log)

  } else {
    await video.click()
    await page.waitForSelector('.html5-video-container')
    console.log(page.url())

    const knownDialogs = `ä¸ç»å·¨å¤§çš„å›°éš¾ï¼Œä¸ä¼šæœ‰ä¼Ÿå¤§çš„äº‹ä¸šã€‚â€”â€”ä¼å°”æ³°
  è‹¦éš¾ç£¨ç‚¼ä¸€äº›äººï¼Œä¹Ÿæ¯ç­å¦ä¸€äº›äººã€‚â€”â€”å¯Œå‹’
  æ”¹å˜ä½ çš„æƒ³æ³•ï¼Œä½ å°±æ”¹å˜äº†è‡ªå·±çš„ä¸–ç•Œã€‚â€”â€”æ–‡æ£®ç‰¹Â·çš®å°”
  ä¸è¦ç­‰å¾…ï¼Œæ—¶æœºæ°¸è¿œä¸ä¼šæ°åˆ°å¥½å¤„ã€‚â€”â€”æ‹¿ç ´ä»‘Â·å¸Œå°”
  ç”Ÿå‘½å¦‚åŒå¯“è¨€ï¼Œå…¶ä»·å€¼ä¸åœ¨ä¸é•¿çŸ­ï¼Œè€Œåœ¨ä¸å†…å®¹ã€‚â€”â€”å¡æ¶…å¡
  ä½ ç›¸ä¿¡ä»€ä¹ˆï¼Œä½ å°±æˆä¸ºä»€ä¹ˆæ ·çš„äººã€‚â€”â€”å¥¥æ™®æ‹‰Â·æ¸©å¼—ç‘
  ç”Ÿå‘½ä¸å¯èƒ½æœ‰ä¸¤æ¬¡ï¼Œä½†è®¸å¤šäººè¿ä¸€æ¬¡ä¹Ÿä¸å–„äºåº¦è¿‡ã€‚â€”â€”å•å‡¯ç‰¹
  äººçš„ä¸€ç”Ÿæ˜¯çŸ­çš„ï¼Œä½†å¦‚æœå‘åŠ£åœ°è¿‡è¿™ä¸€ç”Ÿï¼Œå°±å¤ªé•¿äº†ã€‚â€”â€”èå£«æ¯”äºš
  æˆ‘çš„åŠªåŠ›æ±‚å­¦æ²¡æœ‰å¾—åˆ°åˆ«çš„å¥½å¤„ï¼Œåªä¸è¿‡æ˜¯æ„ˆæ¥æ„ˆå‘è§‰è‡ªå·±çš„æ— çŸ¥ã€‚â€”â€”ç¬›å¡å„¿
  ç”Ÿæ´»çš„é“è·¯ä¸€æ—¦é€‰å®šï¼Œå°±è¦å‹‡æ•¢åœ°èµ°åˆ°åº•ï¼Œå†³ä¸å›å¤´ã€‚â€”â€”å·¦æ‹‰
  ç”Ÿå‘½æ˜¯ä¸€æ¡è‰°é™©çš„å³¡è°·ï¼Œåªæœ‰å‹‡æ•¢çš„äººæ‰èƒ½é€šè¿‡ã€‚â€”â€”ç±³æ­‡æ½˜
  è¦ä¹ˆä½ ä¸»å®°ç”Ÿæ´»ï¼Œè¦ä¹ˆä½ è¢«ç”Ÿæ´»ä¸»å®°ã€‚â€”â€”å‰å§†Â·ç½—æ©
  ä¸å¹¸å¯èƒ½æˆä¸ºé€šå‘å¹¸ç¦çš„æ¡¥æ¢ã€‚â€”â€”æ—¥æœ¬è°šè¯­
  äººç”Ÿå°±æ˜¯å­¦æ ¡ã€‚åœ¨é‚£é‡Œï¼Œä¸å…¶è¯´å¥½çš„æ•™å¸ˆæ˜¯å¹¸ç¦ï¼Œä¸å¦‚è¯´å¥½çš„æ•™å¸ˆæ˜¯ä¸å¹¸ã€‚â€”â€”æµ·è´å°”
  æ¥å—æŒ‘æˆ˜ï¼Œå°±å¯ä»¥äº«å—èƒœåˆ©çš„å–œæ‚¦ã€‚â€”â€”æ°çº³å‹’å°”Â·ä¹”æ²»Â·SÂ·å·´é¡¿
  èŠ‚åˆ¶ä½¿å¿«ä¹å¢åŠ å¹¶ä½¿äº«å—åŠ å¼ºã€‚â€”â€”å¾·è°Ÿå…‹åˆ©ç‰¹
  ä»Šå¤©åº”åšçš„äº‹æ²¡æœ‰åšï¼Œæ˜å¤©å†æ—©ä¹Ÿæ˜¯è€½è¯¯äº†ã€‚â€”â€”è£´æ–¯æ³°æ´›é½
  å†³å®šä¸€ä¸ªäººçš„ä¸€ç”Ÿï¼Œä»¥åŠæ•´ä¸ªå‘½è¿çš„ï¼Œåªæ˜¯ä¸€ç¬ä¹‹é—´ã€‚â€”â€”æ­Œå¾·
  ä¸€ä¸ªä¸æ³¨æ„å°äº‹æƒ…çš„äººï¼Œæ°¸è¿œä¸ä¼šæˆå°±å¤§äº‹ä¸šã€‚â€”â€”å¡è€åŸº
  æµªè´¹æ—¶é—´æ˜¯ä¸€æ¡©å¤§ç½ªè¿‡ã€‚â€”â€”å¢æ¢­
  æ—¢ç„¶æˆ‘å·²ç»è¸ä¸Šè¿™æ¡é“è·¯ï¼Œé‚£ä¹ˆï¼Œä»»ä½•ä¸œè¥¿éƒ½ä¸åº”å¦¨ç¢æˆ‘æ²¿ç€è¿™æ¡è·¯èµ°ä¸‹å»ã€‚â€”â€”åº·å¾·
  æ•™è‚²éœ€è¦èŠ±è´¹é’±ï¼Œè€Œæ— çŸ¥ä¹Ÿæ˜¯ä¸€æ ·ã€‚â€”â€”å…‹åŠ³æ–¯Â·è«ç‘Ÿçˆµå£«
  åšæŒæ„å¿—ä¼Ÿå¤§çš„äº‹ä¸šéœ€è¦å§‹ç»ˆä¸æ¸çš„ç²¾ç¥ã€‚â€”â€”ä¼å°”æ³°
  ä½ æ´»äº†å¤šå°‘å²ä¸ç®—ä»€ä¹ˆï¼Œé‡è¦çš„æ˜¯ä½ æ˜¯å¦‚ä½•åº¦è¿‡è¿™äº›å²æœˆçš„ã€‚â€”â€”äºšä¼¯æ‹‰ç½•Â·æ—è‚¯
  å†…å¤–ç›¸åº”ï¼Œè¨€è¡Œç›¸ç§°ã€‚â€”â€”éŸ©é
  ä½ çƒ­çˆ±ç”Ÿå‘½å—ï¼Ÿé‚£ä¹ˆåˆ«æµªè´¹æ—¶é—´ï¼Œå› ä¸ºæ—¶é—´æ˜¯ç»„æˆç”Ÿå‘½çš„ææ–™ã€‚â€”â€”å¯Œå…°å…‹æ—
  åšå¼ºçš„ä¿¡å¿ƒï¼Œèƒ½ä½¿å¹³å‡¡çš„äººåšå‡ºæƒŠäººçš„äº‹ä¸šã€‚â€”â€”é©¬å°”é¡¿
  è¯»ä¸€åˆ‡å¥½ä¹¦ï¼Œå°±æ˜¯å’Œè®¸å¤šé«˜å°šçš„äººè°ˆè¯ã€‚â€”â€”ç¬›å¡å„¿
  çœŸæ­£çš„äººç”Ÿï¼Œåªæœ‰åœ¨ç»è¿‡è‰°éš¾å“ç»çš„æ–—äº‰ä¹‹åæ‰èƒ½å®ç°ã€‚â€”â€”å¡æ¶…å¡
  ä¼Ÿå¤§çš„äº‹ä¸šï¼Œéœ€è¦å†³å¿ƒï¼Œèƒ½åŠ›ï¼Œç»„ç»‡å’Œè´£ä»»æ„Ÿã€‚â€”â€”æ˜“åœç”Ÿ
  æ²¡æœ‰äººäº‹å…ˆäº†è§£è‡ªå·±åˆ°åº•æœ‰å¤šå¤§çš„åŠ›é‡ï¼Œç›´åˆ°ä»–è¯•è¿‡ä»¥åæ‰çŸ¥é“ã€‚â€”â€”æ­Œå¾·
  æ•¢äºæµªè´¹å“ªæ€•ä¸€ä¸ªé’Ÿå¤´æ—¶é—´çš„äººï¼Œè¯´æ˜ä»–è¿˜ä¸æ‡‚å¾—çæƒœç”Ÿå‘½çš„å…¨éƒ¨ä»·å€¼ã€‚â€”â€”è¾¾å°”æ–‡
  æ„Ÿæ¿€æ¯ä¸€ä¸ªæ–°çš„æŒ‘æˆ˜ï¼Œå› ä¸ºå®ƒä¼šé”»é€ ä½ çš„æ„å¿—å’Œå“æ ¼ã€‚â€”â€”ä½šå
  å…±åŒçš„äº‹ä¸šï¼Œå…±åŒçš„æ–—äº‰ï¼Œå¯ä»¥ä½¿äººä»¬äº§ç”Ÿå¿å—ä¸€åˆ‡çš„åŠ›é‡ã€‚ã€€â€”â€”å¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸº
  å¤ä¹‹ç«‹å¤§äº‹è€…ï¼Œä¸æƒŸæœ‰è¶…ä¸–ä¹‹æ‰ï¼Œäº¦å¿…æœ‰åšå¿ä¸æ‹”ä¹‹å¿—ã€‚â€”â€”è‹è½¼
  æ•…ç«‹å¿—è€…ï¼Œä¸ºå­¦ä¹‹å¿ƒä¹Ÿï¼›ä¸ºå­¦è€…ï¼Œç«‹å¿—ä¹‹äº‹ä¹Ÿã€‚â€”â€”ç‹é˜³æ˜
  è¯»ä¸€æœ¬å¥½ä¹¦ï¼Œå°±å¦‚åŒå’Œä¸€ä¸ªé«˜å°šçš„äººåœ¨äº¤è°ˆã€‚â€”â€”æ­Œå¾·
  å­¦ä¹ æ˜¯åŠ³åŠ¨ï¼Œæ˜¯å……æ»¡æ€æƒ³çš„åŠ³åŠ¨ã€‚â€”â€”ä¹Œç”³æ–¯åŸº
  å¥½çš„ä¹¦ç±æ˜¯æœ€è´µé‡çš„çå®ã€‚â€”â€”åˆ«æ—æ–¯åŸº
  è¯»ä¹¦æ˜¯æ˜“äº‹ï¼Œæ€ç´¢æ˜¯éš¾äº‹ï¼Œä½†ä¸¤è€…ç¼ºä¸€ï¼Œä¾¿å…¨æ— ç”¨å¤„ã€‚â€”â€”å¯Œå…°å…‹æ—
  è¯»ä¹¦æ˜¯åœ¨åˆ«äººæ€æƒ³çš„å¸®åŠ©ä¸‹ï¼Œå»ºç«‹èµ·è‡ªå·±çš„æ€æƒ³ã€‚â€”â€”é²å·´é‡‘
  åˆç†å®‰æ’æ—¶é—´ï¼Œå°±ç­‰äºèŠ‚çº¦æ—¶é—´ã€‚â€”â€”åŸ¹æ ¹
  ä½ æƒ³æˆä¸ºå¹¸ç¦çš„äººå—ï¼Ÿä½†æ„¿ä½ é¦–å…ˆå­¦ä¼šåƒå¾—èµ·è‹¦ã€‚â€”â€”å± æ ¼æ¶…å¤«
  æŠ›å¼ƒæ—¶é—´çš„äººï¼Œæ—¶é—´ä¹ŸæŠ›å¼ƒä»–ã€‚â€”â€”èå£«æ¯”äºš
  æ™®é€šäººåªæƒ³åˆ°å¦‚ä½•åº¦è¿‡æ—¶é—´ï¼Œæœ‰æ‰èƒ½çš„äººè®¾æ³•åˆ©ç”¨æ—¶é—´ã€‚â€”â€”å”æœ¬å
  ä¸€æ¬¡å¤±è´¥ï¼Œåªæ˜¯è¯æ˜æˆ‘ä»¬æˆåŠŸçš„å†³å¿ƒè¿˜å¤Ÿåšå¼ºã€‚â€”â€”åš ç»´
  å–å¾—æˆå°±æ—¶åšæŒä¸æ‡ˆï¼Œè¦æ¯”é­åˆ°å¤±è´¥æ—¶é¡½å¼ºä¸å±ˆæ›´é‡è¦ã€‚â€”â€”æ‹‰ç½—ä»€å¤«ç§‘
  äººçš„ä¸€ç”Ÿæ˜¯çŸ­çš„ï¼Œä½†å¦‚æœå‘åŠ£åœ°è¿‡è¿™ä¸€ç”Ÿï¼Œå°±å¤ªé•¿äº†ã€‚â€”â€”èå£«æ¯”äºš
  å¤±è´¥æ˜¯åšå¿çš„æœ€åè€ƒéªŒã€‚â€”â€”ä¿¾æ–¯éº¦
  ä¸è¦å›é¿è‹¦æ¼å’Œå›°éš¾ï¼ŒæŒºèµ·èº«æ¥å‘å®ƒæŒ‘æˆ˜ï¼Œè¿›è€Œå…‹æœå®ƒã€‚â€”â€”æ± ç”°å¤§ä½œ
  é‚£è„‘è¢‹é‡Œçš„æ™ºæ…§ï¼Œå°±åƒæ‰“ç«çŸ³é‡Œçš„ç«èŠ±ä¸€æ ·ï¼Œä¸å»æ‰“å®ƒæ˜¯ä¸è‚¯å‡ºæ¥çš„ã€‚â€”â€”èå£«æ¯”äºš
  æœ€å›°éš¾çš„äº‹æƒ…å°±æ˜¯è®¤è¯†è‡ªå·±ã€‚â€”â€”å¸Œè…Š
  æœ‰å‹‡æ°”æ‰¿æ‹…å‘½è¿è¿™æ‰æ˜¯è‹±é›„å¥½æ±‰ã€‚â€”â€”é»‘å¡
  æœ€çµç¹çš„äººä¹Ÿçœ‹ä¸è§è‡ªå·±çš„èƒŒè„Šã€‚â€”â€”éæ´²
  é˜…è¯»ä½¿äººå……å®ï¼Œä¼šè°ˆä½¿äººæ•æ·ï¼Œå†™ä½œä½¿äººç²¾ç¡®ã€‚â€”â€”åŸ¹æ ¹
  æœ€å¤§çš„éª„å‚²äºæœ€å¤§çš„è‡ªå‘éƒ½è¡¨ç¤ºå¿ƒçµçš„æœ€è½¯å¼±æ— åŠ›ã€‚â€”â€”æ–¯å®¾è¯ºè
  è‡ªçŸ¥ä¹‹æ˜æ˜¯æœ€éš¾å¾—çš„çŸ¥è¯†ã€‚â€”â€”è¥¿ç­ç‰™
  å‹‡æ°”é€šå¾€å¤©å ‚ï¼Œæ€¯æ‡¦é€šå¾€åœ°ç‹±ã€‚â€”â€”å¡å†…åŠ 
  æœ‰æ—¶å€™è¯»ä¹¦æ˜¯ä¸€ç§å·§å¦™åœ°é¿å¼€æ€è€ƒçš„æ–¹æ³•ã€‚â€”â€”èµ«å°”æ™®æ–¯
  é˜…è¯»ä¸€åˆ‡å¥½ä¹¦å¦‚åŒå’Œè¿‡å»æœ€æ°å‡ºçš„äººè°ˆè¯ã€‚â€”â€”ç¬›å¡å„¿
  è¶Šæ˜¯æ²¡æœ‰æœ¬é¢†çš„å°±è¶ŠåŠ è‡ªå‘½ä¸å‡¡ã€‚â€”â€”é‚“æ‹“
  è¶Šæ˜¯æ— èƒ½çš„äººï¼Œè¶Šå–œæ¬¢æŒ‘å‰”åˆ«äººçš„é”™å„¿ã€‚â€”â€”çˆ±å°”å…°
  çŸ¥äººè€…æ™ºï¼Œè‡ªçŸ¥è€…æ˜ã€‚èƒœäººè€…æœ‰åŠ›ï¼Œè‡ªèƒœè€…å¼ºã€‚â€”â€”è€å­
  æ„å¿—åšå¼ºçš„äººèƒ½æŠŠä¸–ç•Œæ”¾åœ¨æ‰‹ä¸­åƒæ³¥å—ä¸€æ ·ä»»æ„æ‰æã€‚â€”â€”æ­Œå¾·
  æœ€å…·æŒ‘æˆ˜æ€§çš„æŒ‘æˆ˜è«è¿‡äºæå‡è‡ªæˆ‘ã€‚â€”â€”è¿ˆå…‹å°”Â·FÂ·æ–¯ç‰¹åˆ©
  å¤±è´¥ä¹Ÿæ˜¯æˆ‘éœ€è¦çš„ï¼Œå®ƒå’ŒæˆåŠŸå¯¹æˆ‘ä¸€æ ·æœ‰ä»·å€¼ã€‚â€”â€”çˆ±è¿ªç”Ÿ
  ä¸€ä¸ªäººå³ä½¿å·²ç™»ä¸Šé¡¶å³°ï¼Œä¹Ÿä»è¦è‡ªå¼ºä¸æ¯ã€‚â€”â€”ç½—ç´ Â·è´å…‹
  æœ€å¤§çš„æŒ‘æˆ˜å’Œçªç ´åœ¨äºç”¨äººï¼Œè€Œç”¨äººæœ€å¤§çš„çªç ´åœ¨äºä¿¡ä»»äººã€‚â€”â€”é©¬äº‘
  è‡ªå·±æ´»ç€ï¼Œå°±æ˜¯ä¸ºäº†ä½¿åˆ«äººè¿‡å¾—æ›´ç¾å¥½ã€‚â€”â€”é›·é”‹
  è¦æŒæ¡ä¹¦ï¼Œè«è¢«ä¹¦æŒæ¡ï¼›è¦ä¸ºç”Ÿè€Œè¯»ï¼Œè«ä¸ºè¯»è€Œç”Ÿã€‚â€”â€”å¸ƒå°”æ²ƒ
  è¦çŸ¥é“å¯¹å¥½äº‹çš„ç§°é¢‚è¿‡äºå¤¸å¤§ï¼Œä¹Ÿä¼šæ‹›æ¥äººä»¬çš„åæ„Ÿè½»è”‘å’Œå«‰å¦’ã€‚â€”â€”åŸ¹æ ¹
  è°å’Œæˆ‘ä¸€æ ·ç”¨åŠŸï¼Œè°å°±ä¼šå’Œæˆ‘ä¸€æ ·æˆåŠŸã€‚â€”â€”è«æ‰ç‰¹
  ä¸€åˆ‡èŠ‚çœï¼Œå½’æ ¹åˆ°åº•éƒ½å½’ç»“ä¸ºæ—¶é—´çš„èŠ‚çœã€‚â€”â€”é©¬å…‹æ€
  æ„å¿—å‘½è¿å¾€å¾€èƒŒé“è€Œé©°ï¼Œå†³å¿ƒåˆ°æœ€åä¼šå…¨éƒ¨æ¨å€’ã€‚â€”â€”èå£«æ¯”äºš
  è¿‡å»ä¸€åˆ‡æ—¶ä»£çš„ç²¾åå°½åœ¨ä¹¦ä¸­ã€‚â€”â€”å¡è±å°”
  æ·±çª¥è‡ªå·±çš„å¿ƒï¼Œè€Œåå‘è§‰ä¸€åˆ‡çš„å¥‡è¿¹åœ¨ä½ è‡ªå·±ã€‚â€”â€”åŸ¹æ ¹
  åªæœ‰æŠŠæŠ±æ€¨ç¯å¢ƒçš„å¿ƒæƒ…ï¼ŒåŒ–ä¸ºä¸Šè¿›çš„åŠ›é‡ï¼Œæ‰æ˜¯æˆåŠŸçš„ä¿è¯ã€‚â€”â€”ç½—æ›¼Â·ç½—å…°
  çŸ¥ä¹‹è€…ä¸å¦‚å¥½ä¹‹è€…ï¼Œå¥½ä¹‹è€…ä¸å¦‚ä¹ä¹‹è€…ã€‚â€”â€”å­”å­
  å‹‡çŒ›ã€å¤§èƒ†å’Œåšå®šçš„å†³å¿ƒèƒ½å¤ŸæŠµå¾—ä¸Šæ­¦å™¨çš„ç²¾è‰¯ã€‚â€”â€”è¾¾Â·èŠ¬å¥‡
  æ„å¿—æ˜¯ä¸€ä¸ªå¼ºå£®çš„ç›²äººï¼Œå€šé åœ¨æ˜çœ¼çš„è·›å­è‚©ä¸Šã€‚â€”â€”å”æœ¬å
  åªæœ‰æ°¸è¿œèººåœ¨æ³¥å‘é‡Œçš„äººï¼Œæ‰ä¸ä¼šå†æ‰è¿›å‘é‡Œã€‚â€”â€”é»‘æ ¼å°”
  å¸Œæœ›çš„ç¯ä¸€æ—¦ç†„ç­ï¼Œç”Ÿæ´»åˆ¹é‚£é—´å˜æˆäº†ä¸€ç‰‡é»‘æš—ã€‚â€”â€”æ™®åˆ—å§†æ˜Œå¾·
  è¦æˆåŠŸä¸éœ€è¦ä»€ä¹ˆç‰¹åˆ«çš„æ‰èƒ½ï¼Œåªè¦æŠŠä½ èƒ½åšçš„å°äº‹åšå¾—å¥½å°±è¡Œäº†ã€‚â€”â€”ç»´é¾™
  å½¢æˆå¤©æ‰çš„å†³å®šå› ç´ åº”è¯¥æ˜¯å‹¤å¥‹ã€‚â€”â€”éƒ­æ²«è‹¥
  å­¦åˆ°å¾ˆå¤šä¸œè¥¿çš„è¯€çªï¼Œå°±æ˜¯ä¸€ä¸‹å­ä¸è¦å­¦å¾ˆå¤šã€‚â€”â€”æ´›å…‹
  è‡ªå·±çš„é‹å­ï¼Œè‡ªå·±çŸ¥é“ç´§åœ¨å“ªé‡Œã€‚â€”â€”è¥¿ç­ç‰™
  æˆ‘ä»¬å”¯ä¸€ä¸ä¼šæ”¹æ­£çš„ç¼ºç‚¹æ˜¯è½¯å¼±ã€‚â€”â€”æ‹‰ç½—ä»€ç¦ç§‘
  æˆ‘è¿™ä¸ªäººèµ°å¾—å¾ˆæ…¢ï¼Œä½†æ˜¯æˆ‘ä»ä¸åé€€ã€‚â€”â€”äºšä¼¯æ‹‰ç½•Â·æ—è‚¯
  å‹¿é—®æˆåŠŸçš„ç§˜è¯€ä¸ºä½•ï¼Œä¸”å°½å…¨åŠ›åšä½ åº”è¯¥åšçš„äº‹å§ã€‚â€”â€”ç¾åçº³
  å¯¹äºä¸å±ˆä¸æŒ çš„äººæ¥è¯´ï¼Œæ²¡æœ‰å¤±è´¥è¿™å›äº‹ã€‚â€”â€”ä¿¾æ–¯éº¦
  å­¦é—®æ˜¯å¼‚å¸¸çè´µçš„ä¸œè¥¿ï¼Œä»ä»»ä½•æºæ³‰å¸æ”¶éƒ½ä¸å¯è€»ã€‚â€”â€”é˜¿åœÂ·æ—¥Â·æ³•æ‹‰å…¹
  åšå¼ºçš„ä¿¡å¿µèƒ½èµ¢å¾—å¼ºè€…çš„å¿ƒï¼Œå¹¶ä½¿ä»–ä»¬å˜å¾—æ›´åšå¼ºã€‚ â€”â€”ç™½å“²ç‰¹
  ä¸€ä¸ªäººå‡ ä¹å¯ä»¥åœ¨ä»»ä½•ä»–æ€€æœ‰æ— é™çƒ­å¿±çš„äº‹æƒ…ä¸ŠæˆåŠŸã€‚ â€”â€”æŸ¥å°”æ–¯Â·å²è€ƒä¼¯
  å“è¶Šçš„äººä¸€å¤§ä¼˜ç‚¹æ˜¯ï¼šåœ¨ä¸åˆ©ä¸è‰°éš¾çš„é­é‡é‡Œç™¾æŠ˜ä¸é¥¶ã€‚â€”â€”è´å¤šèŠ¬
  æœ¬æ¥æ— æœ›çš„äº‹ï¼Œå¤§èƒ†å°è¯•ï¼Œå¾€å¾€èƒ½æˆåŠŸã€‚â€”â€”èå£«æ¯”äºš
  æˆ‘ä»¬è‹¥å·²æ¥å—æœ€åçš„ï¼Œå°±å†æ²¡æœ‰ä»€ä¹ˆæŸå¤±ã€‚â€”â€”å¡è€åŸº
  åªæœ‰åœ¨äººç¾¤ä¸­é—´ï¼Œæ‰èƒ½è®¤è¯†è‡ªå·±ã€‚â€”â€”å¾·å›½
  ä¹¦ç±æŠŠæˆ‘ä»¬å¼•å…¥æœ€ç¾å¥½çš„ç¤¾ä¼šï¼Œä½¿æˆ‘ä»¬è®¤è¯†å„ä¸ªæ—¶ä»£çš„ä¼Ÿå¤§æ™ºè€…ã€‚â€”â€”å²ç¾å°”æ–¯
  å½“ä¸€ä¸ªäººç”¨å·¥ä½œå»è¿æ¥å…‰æ˜ï¼Œå…‰æ˜å¾ˆå¿«å°±ä¼šæ¥ç…§è€€ç€ä»–ã€‚â€”â€”å†¯å­¦å³°
  å¦‚æœä½ èƒ½åšæ¢¦ï¼Œä½ å°±èƒ½å®ç°å®ƒã€‚â€”â€”å‰æ ¼Â·é‡‘å…‹æ‹‰
  `
    const str = `æ’­ä¸»å¥½å‘€ï¼Œæ‚¨çš„é¢‘é“å†…å®¹å¾ˆæ£’ï¼å€Ÿè´µé¢‘é“åˆ†äº«ä¸€ä¸ªå…è´¹VPNç»™å¤§é™†ç½‘å‹æµç•…çœ‹ğŸ“ºæ²¹ç®¡ï¼Œè°·æ­Œå•†åº—è¯„åˆ†4.7â¤ï¸ï¼Œæ°¸ä¹…å…è´¹ï¼Œä¸é™æµé‡ã€‚è°·æ­Œå•†åº—ä¸‹è½½ğŸ“²
  https://play.google.com/store/apps/details?id=com.stargate.vpn 
  Apkpureä¸‹è½½ https://apkpure.com/p/com.stargate.vpn

  `
    const dialogArray = knownDialogs.split('\n')
  
    const tmp = dialogArray[getRandomInt(0, dialogArray.length)]

    await page.evaluate((y) => { document.scrollingElement.scrollBy(0, y); }, 100);

    await page.waitForTimeout(1000 * getRandomInt(10, 30))

    //await page.click('ytd-subscribe-button-renderer')

    if (await page.$('#simplebox-placeholder') != null) {
      await page.type('#simplebox-placeholder', str + tmp)
      await page.waitForTimeout(1000 * getRandomInt(10, 30))
      await page.click('#submit-button')
      await page.waitForTimeout(1000 * getRandomInt(10, 30))
      saveVid(vid)
    } else {
      console.error('not found simplebox')
    }
   

    await page.goBack()
    await page.waitForTimeout(1000)
  }

}
// puppeteer.use(require('puppeteer-extra-plugin-user-data-dir')( {
//   deleteTemporary: false,
//   deleteExisting: false,
//   files: []
// }))

(async () => {
// That's it, the rest is puppeteer usage as normal ğŸ˜Š
  
  let browser;
  if (useLanch) {
      browser = await puppeteer.launch({
      headless: false,
      slowMo: 50,
    })
  } else {
    //const browserWSEndpoint = 'ws://127.0.0.1:9222/devtools/browser/c2d8b4f7-6bf9-47ae-8da2-a4ff6234a244';
    const browserURL = 'http://127.0.0.1:9222';
    browser = await puppeteer.connect({ browserURL });
  }
  

  
  
  const page = await browser.newPage()

  //await page.setViewport({ width: 800, height: 600 })
  
  await page.setViewport({
    width: 1000,
    height: 1500
  });


// ... puppeteer code
  const cookiesString = await fs.readFile('./cookies.json');
  const cookies = JSON.parse(cookiesString);
  await page.setCookie(...cookies);


  for (var keyword of keywords) {
    let listUrl = 'https://www.youtube.com/results?sp=EgQIAhAB&search_query=' + encodeURI(keyword)
    await page.goto(listUrl)
    await scrollToBottom(page)
    await page.waitForSelector('ytd-thumbnail.ytd-video-renderer')
    const videos = await page.$$('ytd-thumbnail.ytd-video-renderer')
    console.log(keyword+ " list count: " + videos.length)

    for (var v of videos) {
      try {
        await autoComment(page, v)
      } catch (e) {
        console.error(e)
        await page.goBack()
      }
    }
    console.log('all videos hanlded.')

  }



})();